@(tpl: models.MainTemplate,
  changes: lib.PaginatedCollection[com.gilt.apidoc.api.v0.models.Change],
  org: Option[com.gilt.apidoc.api.v0.models.Organization] = None,
  app: Option[com.gilt.apidoc.api.v0.models.Application] = None
)(implicit flash: Flash)

@main(tpl) {

  @if(!org.isEmpty && !app.isEmpty) {
    <a href="@routes.HistoryController.index()">All</a> /
    <a href="@routes.HistoryController.organization(org.get.key)">@org.get.key</a> /
    @app.get.key
  } else {
    @if(!org.isEmpty) {
      <a href="@routes.HistoryController.index()">All</a> / @org.get.key
    }
  }

  @if(changes.isEmpty) {
    <em>No changes found</em>

  } else {
    <table class="table table-hover table-condensed">
      <tbody>
        @changes.items.map { change =>
         <tr>
           <td>@lib.DateHelper.shortDate(tpl.timeZone, change.changedAt)</td>
           <td>@change.organization.key/@change.application.key</td>
           <td>
             <a href="@routes.Versions.show(change.organization.key, change.application.key, change.fromVersion.version)">@change.fromVersion.version</a> -
             <a href="@routes.Versions.show(change.organization.key, change.application.key, change.toVersion.version)">@change.toVersion.version</a>
           </td>
           <td>
             @{change.diff match {
               case com.gilt.apidoc.api.v0.models.DiffBreaking(desc) => "Breaking"
               case com.gilt.apidoc.api.v0.models.DiffNonBreaking(desc) => "Non Breaking"
               case com.gilt.apidoc.api.v0.models.DiffUndefinedType(desc) => "Unkonwn"
             }}
           </td>
           <td>
             @{change.diff match {
               case com.gilt.apidoc.api.v0.models.DiffBreaking(desc) => desc
               case com.gilt.apidoc.api.v0.models.DiffNonBreaking(desc) => desc
               case com.gilt.apidoc.api.v0.models.DiffUndefinedType(desc) => desc
             }}
           </td>
         </tr>
       }
      </tbody>
    </table>

    @if(changes.hasPrevious || changes.hasNext) {
      <ul class="pager">
        @if(changes.hasPrevious) {
          @if(org.isEmpty) {
            <li><a href="@routes.HistoryController.index(changes.page - 1)">Previous</a></li>
          } else {
            @if(app.isEmpty) {
              <li><a href="@routes.HistoryController.organization(orgKey = org.get.key, changes.page - 1)">Previous</a></li>
            } else {
              <li><a href="@routes.HistoryController.application(orgKey = org.get.key, applicationKey = app.get.key, changes.page - 1)">Previous</a></li>
            }
          }
        }
        @if(changes.hasNext) {
          @if(org.isEmpty) {
            <li><a href="@routes.HistoryController.index(changes.page + 1)">Next</a></li>
          } else {
            @if(app.isEmpty) {
              <li><a href="@routes.HistoryController.organization(org.get.key, changes.page + 1)">Next</a></li>
            } else {
              <li><a href="@routes.HistoryController.application(orgKey = org.get.key, applicationKey = app.get.key, changes.page + 1)">Next</a></li>
            }
          }
        }
      </ul>
    }
  }

}
