{
    "name": "apidoc internal",
    "description": "Internal models used in the implementation of apidoc",
    "apidoc": {
      "version": "0.9.11"
    },

    "imports": [
	{ "uri": "http://www.apidoc.me/gilt/apidoc-api/0.9.11/service.json" }
    ],

    "unions": {
	"task_data": {
	    "types": [
		{ "type": "task_data_index_application", "description": "Task to update the search index following a change in application" },
		{ "type": "task_data_diff_version", "description": "Task triggered whenever a version changes. Diffs the service to record what actually changed" }
	    ]
	},

	"difference": {
	    "types": [
		{ "type": "difference_breaking" },
		{ "type": "difference_non_breaking" }
	    ]
	}

    },

    "models": {

	"task": {
	    "fields": [
                { "name": "guid", "type": "uuid" },
                { "name": "data", "type": "task_data" },
                { "name": "number_attempts", "type": "long", "default": 0, "description": "Records the number of times we have attempted to run this task. Commonly we increment number attempts, process the task, and if succeeds we then delete the task. If it fails, we update last_error. This allows us to retry a task say twice; after which we no longer process the task (can notify an admin of the error)." },
                { "name": "last_error", "type": "string", "required": false }
	    ]
	},

	"task_data_index_application": {
	    "fields": [
                { "name": "version_guid", "type": "uuid" }
	    ]
	},

	"task_data_diff_version": {
	    "fields": [
                { "name": "old_version_guid", "type": "uuid" },
                { "name": "new_version_guid", "type": "uuid" }
	    ]
	},

	"difference_breaking": {
	    "fields": [
                { "name": "description", "type": "string" }
	    ]
	},

	"difference_non_breaking": {
	    "fields": [
                { "name": "description", "type": "string" }
	    ]
	},

	"change": {
	    "description": "Represents a single change from one version of a service to another",
	    "fields": [
                { "name": "guid", "type": "uuid" },
                { "name": "application", "type": "com.gilt.apidoc.api.v0.models.reference" },
                { "name": "from_version", "type": "change_version" },
                { "name": "to_version", "type": "change_version" },
                { "name": "difference", "type": "difference" }
	    ]
	},

	"change_version": {
	    "description": "Represents a simpler model of a version specifically for the use case of displaying changes",
	    "fields": [
                { "name": "guid", "type": "uuid" },
                { "name": "version", "type": "string" }
	    ]
	}

    }

}
